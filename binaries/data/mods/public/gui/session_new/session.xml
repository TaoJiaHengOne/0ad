<?xml version="1.0" encoding="utf-8"?>

<objects>

	<script file="gui/common/functions_global_object.js" />
	<script file="gui/session_new/session.js"/>
	<script file="gui/session_new/selection.js"/>
	<script file="gui/session_new/input.js"/>
	<script file="gui/session_new/music.js"/>
	<script file="gui/session_new/menu.js"/>
	<script file="gui/session_new/selection_details.js"/>
	<script file="gui/session_new/unit_commands.js"/>

	<object name="sn" hotkey="session.gui.toggle">
		<action on="Tick">
			onTick();
		</action>

		<action on="SimulationUpdate">
			onSimulationUpdate();
		</action>

		<action on="Press">
			this.hidden = !this.hidden;
		</action>

		<!-- ================================  ================================ -->
		<!-- ALPHA LABELS (alpha, build time, revision) -->
		<!-- ================================  ================================ -->
		
		<!-- Displays Alpha name and number -->
		<object size="100%-170 0 100%-8 25" name="alphaLabel" type="text" style="centeredText" font="serif-bold-16" textcolor="white">
			<action on="Load"><![CDATA[this.caption = "ALPHA I : Argonaut";]]></action>
		</object>

		<!-- Displays build date and revision number-->
		<object size="100%-170 25 100%-8 45" name="buildTimeLabel" type="text" style="centeredText" font="serif-12" textcolor="white">
			<action on="Load"><![CDATA[this.caption = buildTime(0) + " (" + buildTime(2) + ")";]]></action>
		</object>
	
		<!-- ================================  ================================ -->
		<!-- HOTKEYS (For some reason, they won't work properly unless outside menu) -->
		<!-- ================================  ================================ -->
		
		<!-- Exit button Hotkey  -->
		<object hotkey="leave">
			<action on="Press"><![CDATA[
				messageBox(400, 200, "Do you really want to quit?", "Confirmation", 0,
					["Yes", "No!"], [leaveGame, null]);
			]]></action>
		</object>
		
		<!-- ================================  ================================ -->
		<!-- Developer / Debug items -->
		<!-- ================================  ================================ -->
		
		<!-- Debug text -->
		<object name="debug"
			type="text"
			size="0 50 50% 100%"
			ghost="true"
			textcolor="yellow"
			font="mono-stroke-10"
		/>

		<!-- Dev/cheat commands -->
		<object name="devCommands" size="100%-155 50 100%-16 146" z="200" type="image" sprite="devCommandsBackground"
				hidden="true" hotkey="session.devcommands.toggle">
			<action on="Press">
				this.hidden = !this.hidden;
			</action>

			<object size="0 0 100%-18 16" type="text" style="devCommandsText">Control all units</object>
			<object size="100%-16 0 100% 16" type="checkbox" name="devControlAll" style="wheatCrossBox"/>

			<object size="0 16 100%-18 32" type="text" style="devCommandsText">Display selection state</object>
			<object size="100%-16 16 100% 32" type="checkbox" name="devDisplayState" style="wheatCrossBox"/>

			<object size="0 32 100%-18 48" type="text" style="devCommandsText">Pathfinder overlay</object>
			<object size="100%-16 32 100% 48" type="checkbox" style="wheatCrossBox">
				<action on="Press">Engine.GuiInterfaceCall("SetPathfinderDebugOverlay", this.checked);</action>
			</object>

			<object size="0 48 100%-18 64" type="text" style="devCommandsText">Obstruction overlay</object>
			<object size="100%-16 48 100% 64" type="checkbox" style="wheatCrossBox">
				<action on="Press">Engine.GuiInterfaceCall("SetObstructionDebugOverlay", this.checked);</action>
			</object>

			<object size="0 64 100%-18 80" type="text" style="devCommandsText">Unit motion overlay</object>
			<object size="100%-16 64 100% 80" type="checkbox" style="wheatCrossBox">
				<action on="Press">g_Selection.SetMotionDebugOverlay(this.checked);</action>
			</object>

			<object size="0 80 100%-18 96" type="text" style="devCommandsText">Range overlay</object>
			<object size="100%-16 80 100% 96" type="checkbox" style="wheatCrossBox">
				<action on="Press">Engine.GuiInterfaceCall("SetRangeDebugOverlay", this.checked);</action>
			</object>
		</object>

		<!-- ================================  ================================ -->
		<!-- Pause Overlay -->
		<!-- ================================  ================================ -->
		<object type="button"
			name="pauseOverlay"
			size="0 0 100% 100%"
			tooltip_style="snToolTip"
			tooltip="Click to Unpause Game"
			hidden="true"
			z="0"
		>
			<object size="0 0 100% 100%" type="image" sprite="devCommandsBackground" ghost="true" z="0"/>
			<object size="0 0 100% 100%" type="text" style="largeBoldCenteredText" textcolor="white" ghost="true" z="0">Game Paused</object>
			<action on="Press">togglePause();</action>
		</object>

		<!-- ================================  ================================ -->
		<!-- Settings Window -->
		<!-- ================================  ================================ -->
		<object name="settingsWindow"
			style="wheatWindow"
			type="image"
			size="50%-180 50%-200 50%+180 50%+50"
			hidden="true"
			z="50"
		>
			<object name="settingsTitleBar" style="wheatWindowTitleBar" type="text">Settings</object>

			<object name="settingsOptions"
				size="30 30 100%-30 175"
				type="image"
				style="goldPanel"
			>
				<!-- Settings / shadows -->
				<object size="0 10 100%-80 35" type="text" style="settingsText" ghost="true">Enable Shadows</object>
				<object name="shadowsCheckbox" size="100%-56 15 100%-30 40" type="checkbox" style="wheatCrossBox" checked="true">
					<action on="Load">if (renderer.shadows) this.checked = true; else this.checked = false;</action>
					<action on="Press">renderer.shadows = this.checked;</action>
				</object>	
				
				<!-- Settings / Water -->
				<object size="0 35 100%-80 60" type="text" style="settingsText" ghost="true">Enable Water Reflections</object>
				<object name="fancyWaterCheckbox" size="100%-56 40 100%-30 65"  type="checkbox" style="wheatCrossBox" checked="true">
					<action on="Load">if (renderer.fancyWater) this.checked = true; else this.checked = false;</action>
					<action on="Press">renderer.fancyWater = this.checked;</action>
				</object>
				
				<!-- Settings / Music-->
				<object size="0 60 100%-80 85" type="text" style="settingsText" ghost="true">Enable Music</object>
				<object size="100%-56 65 100%-30 90" type="checkbox" style="wheatCrossBox" checked="true">
					<action on="Press">if (this.checked) startMusic(); else stopMusic();</action>
				</object>
				
				<!-- Settings / Dev Overlay -->
				<object size="0 85 100%-80 110" type="text" style="settingsText" ghost="true">Developer Overlay</object>
				<object size="100%-56 90 100%-30 115" type="checkbox" style="wheatCrossBox" checked="false">
					<action on="Press">toggleDeveloperOverlay();</action>
				</object>

				<!-- Settings / Dev Overlay -->
				<object size="0 110 100%-80 135" type="text" style="settingsText" ghost="true">Group Selections by Rank</object>
				<object size="100%-56 115 100%-30 140" type="checkbox" style="wheatCrossBox" checked="true">
					<action on="Press">groupSelectionByRank(this.checked);</action>
				</object>
			</object>

			<object name="settingsOKButton"
				style="wheatButtonFancy"
				type="button"
				size="50%-50 100%-52 50%+50 100%-20" 
			>
				<object size="0 0 100% 100%" type="text" style="centeredText" name="settingsOKButtonText" ghost="true">OK</object>
				<action on="Press">toggleSettingsWindow();</action>
			</object>
		</object>

		<!-- ================================  ================================ -->
		<!-- Menu Details -->
		<!-- ================================  ================================ -->
		<object name="menu"
			size="0 0 114 128"
			type="image"
			sprite="menuBackground"
			hidden="true"
		>
			<!-- Settings button -->
			<object type="button"
				name="settingsButton"
				style="wheatButtonFancy"
				size="0 32 114 64"
				tooltip_style="snToolTip"
			>
				<object size="0 0 100% 100%" type="text" style="centeredText" name="settingsButtonText" ghost="true">Settings</object>
				<action on="Press">toggleSettingsWindow();</action>
			</object>

			<!-- Pause Button -->
			<object type="button"
				style="wheatButtonFancy"
				name="pauseButton"
				size="0 64 114 96"
				tooltip_style="snToolTip"
			>
				<object size="0 0 100% 100%" type="text" ghost="true" style="centeredText">Pause Game</object>
				<action on="Press">togglePause();</action>
			</object>

			<!-- Exit button -->
			<object type="button"
				name="exitButton"
				style="wheatButtonFancy"
				size="0 96 114 128"
				tooltip_style="snToolTip"
			>
				<object size="0 0 100% 100%" type="text" style="centeredText" name="exitButtonText" ghost="true" font="serif-14">Quit Game</object>
				<action on="Press">
					toggleMenu();
					<![CDATA[messageBox(400, 200, "Do you really want to quit?", "Confirmation", 0, ["Yes", "No!"], [leaveGame, null]);]]>
				</action>
			</object>
		</object>

		<!-- Menu Button -->
		<object type="button"
			name="menuButton"
			style="wheatButtonFancy"
			size="0 0 114 32"
			tooltip_style="snToolTip"
		>
			<object size="0 0 100% 100%" type="text" style="largeBoldCenteredText" name="menuButtonText" ghost="true">Menu</object>
			<action on="Press">toggleMenu();</action>
		</object>

		<!-- ================================  ================================ -->
		<!-- Bottom-left Minimap and Resource Panel-->
		<!-- ================================  ================================ -->
		<object
			name="mapAndResourcePanel"
				style="sessionPanelStyle"
				size="0 100%-154 272 100%"
				type="image"
				z="30"
		>
			<!-- Minimap -->
			<object name="minimap">
				<object
					size="24 100%-164 164 100%-24"
					type="image"
					style="wheatWindow"
				/>

				<object name="minimapDisplay"
					type="minimap"
					size="6 100%-182 182 100%-6"
				/>
			</object>

			<!-- Player resource bar -->
			<object
				size="188 100%-130 100% 100%-2"
			>
				<!-- Food -->
				<object size="0 0 100% 26" type="image" style="resourceCounter" tooltip="Food" >
					<object size="0 0 28 24" type="image" style="resourceIcon" cell_id="0"/>
					<object size="28 0 100% 24" type="text" style="resourceText" name="resourceFood"/>
				</object>

				<!-- Wood -->
				<object size="0 26 100% 52" type="image" style="resourceCounter" tooltip="Wood">
					<object size="0 0 28 24" type="image" style="resourceIcon" cell_id="1"/>
					<object size="28 0 100% 24" type="text" style="resourceText" name="resourceWood"/>
				</object>

				<!-- Stone -->
				<object size="0 52 100%78" type="image" style="resourceCounter" tooltip="Stone">
					<object size="0 0 28 24" type="image" style="resourceIcon" cell_id="2"/>
					<object size="28 0 100% 24" type="text" style="resourceText" name="resourceStone"/>
				</object>

				<!-- Metal -->
				<object size="0 78 100% 104" type="image" style="resourceCounter" tooltip="Metal">
					<object size="0 0 28 24" type="image" style="resourceIcon" cell_id="3"/>
					<object size="28 0 100% 24" type="text" style="resourceText" name="resourceMetal"/>
				</object>

				<!-- Population -->
				<object size="0 104 100% 130" type="image" style="resourceCounter" tooltip="Population (current / maximum)">
					<object size="0 0 28 24" type="image" style="resourceIcon" cell_id="4"/>
					<object size="28 0 100% 24" type="text" style="resourceText" name="resourcePop"/>
				</object>
			</object>
		</object>

		<!-- ================================  ================================ -->
		<!-- Bottom-middle selected-units and unit details panel ("Selection Details" is Abbreviated as "sd") -->
		<!-- ================================  ================================ -->
		<object name="selectionDetails"
			type="image"
			style="sessionPanelStyle"
			size="277 100%-154 560 100%"
			hidden="true"
			z="20"
		>
			<!-- Unit Selection Area -->
			<object name="unitSelectionPanel"
				size="92 30 274 56"
			>	 
				<object size="0 0 100% 47">
					<repeat count="24">
						<object name="unitSelectionButton[n]" hidden="true" style="iconButton" type="button" size="0 0 36 36">
							<object name="unitSelectionIcon[n]" type="image" ghost="true" size="3 3 34 34"/>
							<object name="unitSelectionCount[n]" ghost="true" style="groupIconsText" type="text"/>
						</object>
					</repeat>
				</object>
			</object>

			<!-- Big unit icon -->
			<object size= "6 30 86 110" name="sdIcon" type="image" tooltip_style="snToolTip">
				<object type="image" name="sdIconOutline" style="sdIconOutline" ghost="true"/>
				<object type="image" name="sdIconImage" ghost="true"/>
				 <object size="100%-24 -6 100%+6 24" name="sdRankIcon" type="image" cell_id="0" sprite="snIconSheetRank" ghost="true"/>
			</object>

			<!-- Cycle through units area -->
			<object size= "6 120 86 136" name="sdCycleArea" type="image" sprite="menuBackground">
				<object name="sdIconButtonReverse" style="wheatArrowDn" type="button" size="0 0 16 16">
					<action on="Press">reverseCycleThroughSelection();</action>
				</object>

				<object name="sdSelectionCount" ghost="true" style="groupIconsCenteredText" type="text"/>
					
				<object name="sdIconButtonForward" style="wheatArrowUp" type="button" size="100%-16 0 100% 16">
					<action on="Press">cycleThroughSelection();</action>
				</object>
			</object>

			<!-- Health bar -->
			<object size="6 112 86 118" type="image" name="sdHealth" tooltip="Hitpoints" tooltip_style="snToolTip">
				<object type="image" sprite="sdHealthBackground" ghost="true"/>
				<object type="image" sprite="sdHealthForeground" ghost="true" name="sdHealthBar"/>
			</object>

			<!-- Stamina bar -->
			<object size="6 120 86 126" type="image" name="sdStamina" tooltip="Stamina" tooltip_style="snToolTip">
				<object type="image" sprite="sdStaminaBackground" ghost="true"/>
				<object type="image" sprite="sdStaminaForeground" ghost="true" name="sdStaminaBar"/>
			</object>

			<!-- Details text -->
			<object size="6 0 100% 24" name="sdMainText" type="image">
				<object size="-4 0 100% 26" name="sdSpecific" type="text" style="leftAlignedText" font="serif-bold-18" tooltip_style="snToolTip"/>
				<object hidden="true" size="0 20 100% 40" name="sdGeneric" type="text" font="serif-14"/>
			</object>

			<!-- Stats -->
			<object size="86 30 100% 100%" name="sdStatsArea" type="image">
				<!-- Player Name -->
				<object size="0 0 100% 24" name="sdPlayer" type="text" style="centeredText" font="serif-stroke-14" tooltip_style="snToolTip"/>
				
				<!-- Attack stats -->
				<object size="4 32 100% 100%" type="image" name="sdAttack" tooltip="Attack strengths" tooltip_style="snToolTip">
					<object size="-4 -8 36 36" type="image" name="sdAttackImage" ghost="true" sprite="snIconSheetStance" cell_id="1"/>
					<object size="30 0 100% 100%" type="text" name="sdAttackStats" style="statsText"/>
				</object>

				<!-- Armour stats -->
				<object size="100 32 100% 100%" type="image" name="sdArmour" tooltip="Armour strengths" tooltip_style="snToolTip">
					<object size="-4 -4 36 36" type="image" name="sdArmourImage" ghost="true" sprite="snIconSheetStance" cell_id="3"/>
					<object size="30 0 100% 100%" type="text" name="sdArmourStats" style="statsText"/>
				</object>
				
				<!-- Resource Quantity -->
				<object hidden="true" size="50 40 100% 60" type="image" name="sdResources" tooltip="Resources" tooltip_style="snToolTip">
					<object size="0 0 28 24" name="sdResourceIcon" type="image" style="resourceIcon" cell_id="0"/>
					<object size="28 0 100% 100%" name="sdResourceStats" type="text" style="resourceStatsText"/>
				</object>
			</object>
		
<!-- Commands
			<object size="90 100%-30 100% 100%-10" type="image" name="sdCommands" tooltip="Commands" tooltip_style="snToolTip">
				<object name="commandsDeleteButton" style="iconButton" type="button" size="100%-48 0 100%-24 24">
					<object size="0 0 24 24" name="sdCommandsDelete" type="image" style="commandsIcon" cell_id="4"/>
					<action on="Press">deleteUnit()</action>
				</object>
			</object>
 -->
		</object>

		<!-- ================================  ================================ -->
		<!-- Bottom-right commands panel -->
		<!-- ================================  ================================ -->
		<object name="unitCommands"
			type="image"
			style="sessionPanelStyle"
			size="565 100%-154 1024 100%"
			hidden="true"
			z="50"
		>
			<object name="unitConstructionPanel"
				size="0 3 100% 100%"
			>
				<object size="-2 -2 54 54" type="image" sprite="snIconSheetTab" tooltip_style="snToolTip"
					 cell_id="0" tooltip="Construction"/>

				<object size="54 0 100% 50">
					<repeat count="24">
						<object name="unitConstructionButton[n]" hidden="true" style="iconButton" type="button" size="0 0 48 48">
							<object name="unitConstructionIcon[n]" type="image" ghost="true" size="3 3 45 45"/>
						</object>
					</repeat>
				</object>
			</object>

			<object name="unitStancePanel"
				style="goldPanelFrilly"
				size="0 100%-56 100% 100%"
				type="text"
			>
				<object size="-5 -2 59 62" type="image" sprite="snIconSheetTab" tooltip_style="snToolTip"
					 cell_id="4" tooltip="Stances"/>

				[stance commands]
			</object>

			<object name="unitFormationPanel"
				style="goldPanelFrilly"
				size="0 100%-56 100% 100%"
				type="text"
			>
				<object size="-5 -2 59 62" type="image" sprite="snIconSheetTab" tooltip_style="snToolTip"
					 cell_id="5" tooltip="Formations"/>

				[formation commands]
			</object>

			<object name="unitResearchPanel"
				style="goldPanelFrilly"
				size="0 100%-56 100% 100%"
				type="text"
			>
				<object size="-5 -2 59 62" type="image" sprite="snIconSheetTab" tooltip_style="snToolTip"
					 cell_id="1" tooltip="Research"/>

				[research commands]
			</object>

			<object name="unitTrainingPanel"
				size="0 3 100% 100%"
			>
				<object size="-2 -2 54 54" type="image" sprite="snIconSheetTab" tooltip_style="snToolTip"
					 cell_id="2" tooltip="Training"/>

				<object size="54 0 100% 50">
					<repeat count="24">
						<object name="unitTrainingButton[n]" hidden="true" style="iconButton" type="button" size="0 0 48 48">
							<object name="unitTrainingIcon[n]" type="image" ghost="true" size="3 3 45 45"/>
						</object>
					</repeat>
				</object>
			</object>

			<object name="unitQueuePanel"
				style="sessionPanelStyle"
				size="0 -63 100% 100%-164"
				type="image"
			>
				<object size="-2 -2 54 54" type="image" sprite="snIconSheetTab" tooltip_style="snToolTip"
					 cell_id="3" tooltip="Production queue"/>

				<object size="54 3 100% 100%">
					<repeat count="24">
						<object name="unitQueueButton[n]" hidden="true" style="iconButton" type="button" size="0 0 48 48">
							<object name="unitQueueIcon[n]" ghost="true" type="image" size="3 3 45 45"/>
							<object name="unitQueueCount[n]" ghost="true" style="iconButtonCount" type="text"/>
							<object name="unitQueueProgress[n]" ghost="true" style="iconButtonProgress" type="text"/>
						</object>
					</repeat>
				</object>
			</object>
		</object>

	</object>

	<!-- ================================  ================================ -->
	<!-- Selection bandbox -->
	<!-- ================================  ================================ -->
	<object name="bandbox" type="image" sprite="bandbox" ghost="true" hidden="true" z="100"/>

	<!-- ================================  ================================ -->
	<!-- Network status -->
	<!-- ================================  ================================ -->
	<object name="netStatus" type="text" style="netStatus" z="100" hidden="true"/>

</objects>
